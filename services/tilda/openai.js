const { OpenAI } = require('openai')
const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
  organization: process.env.OPENAI_ORG_ID
})

module.exports = async function generatePlanTilda(prompt) {

  const systemPrompt = `–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç. –¢—ã —É–º–µ–µ—à—å —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å —É—Å–ø–µ—à–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω—ã –¥–ª—è –∑–∞–∫–ª—é—á–µ–Ω–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –ø–æ–¥ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –∑–∞–∫–∞–∑—á–∏–∫–∞. –û—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à–æ —É —Ç–µ–±—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø–ª–∞–Ω —Å–æ—Ü–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞. –ó–∞–ø–æ–º–Ω–∏: –æ—Ç —Ç–≤–æ–∏—Ö –±–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω–æ–≤ –∑–∞–≤–∏—Å—è—Ç —Å—É–¥—å–±—ã –∏ –∂–∏–∑–Ω–∏ –ª—é–¥–µ–π.

üìå –§–æ—Ä–º–∞—Ç –∏ —Å—Ç–∏–ª—å:
- –ü–∏—à–∏ –≤ Markdown:
  - \\# –ó–∞–≥–æ–ª–æ–≤–æ–∫\\ ‚Äî —Ä–∞–∑–¥–µ–ª
  - \\## –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫\\ ‚Äî –ø–æ –∂–µ–ª–∞–Ω–∏—é
  - \\ - –ø—É–Ω–∫—Ç —Å–ø–∏—Å–∫–∞\\ ‚Äî —Å–ø–∏—Å–∫–∏
  - \\ –∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç **\\ ‚Äî –∞–∫—Ü–µ–Ω—Ç—ã
- –ë–µ–∑ "—Ç–∏—Ç—É–ª—å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞" –∏ "—Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è" ‚Äî –æ–Ω–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.
- –°—Ç—Ä–æ–≥–∏–π –¥–µ–ª–æ–≤–æ–π —Å—Ç–∏–ª—å. –ë–µ–∑ –º–µ—Ç–∞—Ñ–æ—Ä, —à—É—Ç–æ–∫, –∏ "–≤–æ–¥—ã".
- –í—Å–µ —Å—É–º–º—ã ‚Äî –≤ **—Ä—É–±–ª—è—Ö.
- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∞—Å—á—ë—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏—á–Ω—ã.
- –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ä–µ–º–æ–Ω—Ç, –ø–æ–∫—É–ø–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –¥–æ—Ö–æ–¥—ã –∏ –Ω–∞–ª–æ–≥–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–π. –ü–æ—ç—Ç–∞–ø–Ω—ã–µ —Ä–∞—Å—á—ë—Ç—ã –ø—Ä–∏–ª–æ–∂–∏ –∫ —Ä–∞–∑–¥–µ–ª—É ¬´–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø–ª–∞–Ω¬ª.

- –û–±—ä—ë–º: –æ—Ç 5000 –¥–æ 6000 —Å–ª–æ–≤.
- –ö–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à—ë–Ω.
- –§–æ—Ä–º–∞—Ç –ø—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ Word —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏.

- –í—Å–µ–≥–¥–∞ –ø–∏—à–∏ –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Ü–∞ (‚Äú—è‚Äù, ‚Äú–º–æ–π –±–∏–∑–Ω–µ—Å‚Äù)
`

  const completion = await openai.chat.completions.create({
    model: 'gpt-4o',
    temperature: 0.7,
    max_tokens: 8192,
    messages: [
      { role: 'system', content: systemPrompt },
      { role: 'user', content: prompt }
    ]
  })
console.log(completion.choices?.[0]?.message?.content)
  return completion.choices?.[0]?.message?.content || '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏'
}
